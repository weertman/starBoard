# fields_config.yaml
# Configuration for first-order comparison ranking in starBoard
#
# This file controls:
#   1. Which fields are enabled by default in the ranking
#   2. Per-field weights for weighted averaging
#   3. Scorer parameters for similarity algorithms
#
# === How First-Order Ranking Works ===
#
# For each query, the engine compares it against all gallery members by:
#   1. Computing per-field similarity scores (each in [0, 1])
#   2. Averaging scores across all active fields with data on both sides
#   3. Ranking gallery items by descending combined score
#
# The final score formula is:
#   score = Σ(weight_i × score_i) / Σ(weight_i)
#
# where only fields that are:
#   - enabled (enabled: true below)
#   - have a non-empty value in the query
#   - have a non-empty value in the gallery member
# contribute to the sum.


# =============================================================================
# NUMERIC FIELDS
# =============================================================================
# Scorer: NumericGaussianScorer - exp(-|gallery - query| / (k × MAD))

numeric_fields:
  num_apparent_arms:
    enabled: true
    weight: 1.0
    description: ''
  num_total_arms:
    enabled: false
    weight: 1.0
    description: ''
  tip_to_tip_size_cm:
    enabled: false
    weight: 1.0
    description: ''


# =============================================================================
# ORDINAL FIELDS
# =============================================================================
# Scorer: NumericGaussianScorer (order matters)

ordinal_fields:
  arm_thickness:
    enabled: true
    weight: 1.0
    description: ''
  reticulation_order:
    enabled: true
    weight: 1.0
    description: ''
  rosette_prominence:
    enabled: true
    weight: 1.0
    description: ''
  stripe_extent:
    enabled: true
    weight: 1.0
    description: ''
  stripe_order:
    enabled: true
    weight: 1.0
    description: ''
  stripe_prominence:
    enabled: true
    weight: 1.0
    description: ''


# =============================================================================
# COLOR FIELDS
# =============================================================================
# Scorer: ColorSpaceScorer - exp(-ΔE / threshold) in LAB space

color_fields:
  arm_color:
    enabled: true
    weight: 1.0
    description: ''
  central_disc_color:
    enabled: true
    weight: 1.0
    description: ''
  madreporite_color:
    enabled: true
    weight: 1.0
    description: ''
  overall_color:
    enabled: true
    weight: 1.0
    description: ''
  papillae_central_disc_color:
    enabled: true
    weight: 1.0
    description: ''
  papillae_stripe_color:
    enabled: true
    weight: 1.0
    description: ''
  rosette_color:
    enabled: true
    weight: 1.0
    description: ''
  stripe_color:
    enabled: true
    weight: 1.0
    description: ''


# =============================================================================
# SET/CODE FIELDS
# =============================================================================
# Scorer: ShortArmCodeScorer - fuzzy position-aware matching

set_fields:
  short_arm_code:
    enabled: false
    weight: 1.0
    description: ''


# =============================================================================
# TEXT FIELDS
# =============================================================================
# Scorer: TextEmbeddingBGEScorer or TextNgramScorer

text_fields:
  health_observation:
    enabled: false
    weight: 1.0
    description: ''
  location:
    enabled: false
    weight: 1.0
    description: ''
  unusual_observation:
    enabled: false
    weight: 1.0
    description: ''


# =============================================================================
# PRESETS
# =============================================================================

presets:
  all:
    description: All fields
    fields: []


# =============================================================================
# GLOBAL SETTINGS
# =============================================================================

settings:
  equalize_weights: true
  default_preset: all
  default_top_k: 50


# =============================================================================
# SCORER PARAMETERS
# =============================================================================

scorer_params:
  numeric:
    k: 2.0
    eps: 1.0e-06
  color:
    threshold: 50.0
    fallback_to_exact: true
  short_arm_code:
    sigma: 1.0
    default_n_arms: 5
  text_embedding:
    model_id: BAAI/bge-small-en-v1.5
